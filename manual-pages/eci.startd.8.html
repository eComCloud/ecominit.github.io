<!DOCTYPE html>
<html>
<!-- This is an automatically generated file.  Do not edit.
   Generated by scdoc v1.11.0
   Complete documentation for this program is not available as a GNU info page
   Begin generated content:
 -->
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="style.css" type="text/css" media="all"/>
  <title>eci.startd(8)</title>
</head>
<body>
<table class="head">
  <tr>
    <td class="head-ltitle">eci.startd(8)</td>
    <td class="head-vol">System Manager's Manual</td>
    <td class="head-rtitle">eci.startd(8)</td>
  </tr>
</table>
<div class="manual-text">
<section class="Sh">
<h1 class="Sh" id="NAME"><a class="permalink" href="#NAME">NAME</a></h1>
eci.startd - eComInit main restarter
</section>
<section class="Sh">
<h1 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h1>
<b>/libexec/eci.startd</b> [<b>--system</b> | <b>--user</b>]
<p class="Pp"><b>com.eComCloud.eci.restarter:default</b></p>
</section>
<section class="Sh">
<h1 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h1>
<b>eci.startd</b> is the main restarter for eComInit. In this role it maintains
  a graph of instances so that it can order their start, stop, and restart in
  response to instance state changes and administrative requests. It also acts
  as the default restarter for all instances which do not specify a delegated
  restarter. See <b>eci_restarter(7)</b> for details on the concept of restarter
  and for properties applicable to all restarters.
<section class="Ss">
<h2 class="Ss" id="INSTANCE_DEFINITION"><a class="permalink" href="#INSTANCE_DEFINITION">INSTANCE
  DEFINITION</a></h2>
<b>METHODS</b>
<p class="Pp"><b>eci.startd</b> supports the standard <b>eci_method(7)</b>
    model. The following methods may be defined:</p>
<p class="Pp"><b>ExecStartPre</b> <i>optional</i></p>
<div class="Bd-indent">Ran before starting service.</div>
<p class="Pp"><b>ExecStart</b></p>
<div class="Bd-indent">Ran to start the service.</div>
<p class="Pp"><b>ExecStartPost</b> <i>optional</i></p>
<div class="Bd-indent">Ran after instance starts successfully.</div>
<p class="Pp"><b>ExecStop</b> <i>optional</i></p>
<div class="Bd-indent">Ran to stop the instance.</div>
<p class="Pp"><b>ExecStopPost</b> <i>optional</i></p>
<div class="Bd-indent">Ran after the instance has been stopped.</div>
<p class="Pp">If <b>ExecStartPre</b>, <b>ExecStart</b>, <b>ExecStartPost</b>,
    <b>ExecReload</b>, or <b>ExecStop</b> return an error, or if the instance
    goes down, then the <b>ExecStop</b> method is run.</p>
<p class="Pp"><b>PROPERTIES</b></p>
<p class="Pp"><b>strategy</b> <i>enumerated string</i></p>
<div class="Bd-indent">Specifies a supervision strategy for this instance.
  Available strategies are:
<div class="Bd-indent">&#x2022;<b>simple</b>: Instance considered ready as soon
  as the <b>ExecStart</b> method begins to execute. When that method exits, it
  is regarded as having gone down.</div>
<div class="Bd-indent">&#x2022;<b>group</b>: Instance considered ready as soon
  as the <b>ExecStart</b> method begins to execute. When all PIDs exit, it is
  regarded as having gone down.</div>
<div class="Bd-indent">&#x2022;<b>forking</b>: Instance considered ready either
  a) if property <b>PIDFile</b> is set, the PID file has been created; or b) if
  that property is not set, then the first-launched PID has exited and a new
  child process is present.</div>
<div class="Bd-indent">&#x2022;<b>notify</b>: Instance considered ready when a
  <i>READY=1</i> message is received via the <b>sd_notify(3)</b> interface.
<p class="Pp"></p>
</div>
</div>
If no strategy is specified, defaults to <b>simple</b>.
</section>
<section class="Ss">
<h2 class="Ss" id="INSTANCE_SUBSTATES"><a class="permalink" href="#INSTANCE_SUBSTATES">INSTANCE
  SUBSTATES</a></h2>
<b>eci.startd</b> refines the states as follows:
<p class="Pp"><b>Offline</b>::<b>StartPre</b></p>
<div class="Bd-indent">Unsets <i>Stop Request Flag</i>.
<p class="Pp">Adds current time to the <i>Start Times Ring Buffer</i>. If the
    <b>startLimitBurst</b>'th entry in the ring is less than
    <b>startLimitIntervalSec</b> seconds ago, transitions to
  <b>Maintenance</b>.</p>
<p class="Pp">Launches control method <b>ExecStartPre</b> if it exists,
    otherwise transitions to <b>Start</b>. Arms <i>Start Timer</i>.</p>
<p class="Pp">On <b>ExecStartPre</b>'s completion, disarms <i>Start Timer</i>.
    If method was successful, transitions to Start. Otherwise transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">On timeout of <i>Start Timer</i>, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
</div>
<p class="Pp"><b>Offline</b>::<b>Start</b></p>
<div class="Bd-indent">Launches main method <b>ExecStart</b>.
<p class="Pp">For simple and group services, transitions to
  <b>StartPost</b>.</p>
<p class="Pp">For forking, oneshot, and notify services, arms <i>Start
    Timer</i>. The timer is disarmed and instance transitions to StartPost
  when:</p>
<div class="Bd-indent">&#x2022;for forking services, the main PID has been
  determined (by PID file being read, or by exit of first-launched
  subprocess.)</div>
<div class="Bd-indent">&#x2022;for oneshot services, the method returns 0.</div>
<div class="Bd-indent">&#x2022;for notify services, an <b>sd_notify(3)</b>
  message has been received.
<p class="Pp"></p>
</div>
<p class="Pp">On timeout of <i>Start Timer</i>, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
</div>
<p class="Pp"><b>Offline</b>::<b>StartPost</b></p>
<div class="Bd-indent">Launches control method <b>ExecStartPost</b> if it
  exists, otherwise transitions to <b>Online</b>. Arms <i>Start Timer</i>.
<p class="Pp">On <b>ExecStartPost</b>'s completion, disarms <i>Start Timer</i>.
    If method was successful, transitions to Online. Otherwise transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">On timeout of <i>Start Timer</i>, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">For simple, forking, and notify instances, on exit of <i>Main
    PID</i>, transitions to <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">For group instances, on exit of all PIDs, transitions to
    <b>Offline::Stop</b>.</p>
</div>
<p class="Pp"><b>Online</b></p>
<div class="Bd-indent">For simple, forking, and notify instances, on exit of
  <i>Main PID</i>, transitions to <b>Offline</b>::<b>Stop</b>.
<p class="Pp">For group instances, on exit of all PIDs, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">If <i>Stop Request Flag</i> is set, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
</div>
<p class="Pp"><b>Online::Reload</b></p>
<div class="Bd-indent">Launches control method <b>ExecReload</b> if it exists,
  otherwise transitions to <b>Online</b>. Arms <i>Start Timer</i>.
<p class="Pp">On <b>ExecReload</b>'s completion, disarms <i>Start Timer</i>. If
    method was successful, transitions to Online. Otherwise transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">On timeout of <i>Start Timer</i>, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
<p class="Pp">For simple, forking, and notify instances, on exit of <i>Main
    PID</i>, transitions to <b>Offline::Stop</b>.</p>
<p class="Pp">For group instances, on exit of all PIDs, transitions to
    <b>Offline</b>::<b>Stop</b>.</p>
</div>
<p class="Pp"><b>Offline</b>::<b>Stop</b></p>
<div class="Bd-indent">Launches control method <b>ExecStop</b> if it exists,
  otherwise transitions to <b>Offline::StopTerm</b>. Arms <i>Stop Timer</i>.
<p class="Pp">On <b>ExecStop</b>'s completion, disarms <i>Stop Timer</i>.
    Transitions to <b>Offline</b>::<b>StopTerm</b>.</p>
<p class="Pp">On timeout of <i>StopTimer</i>, transitions to
    <b>Offline</b>::<b>StopTerm</b>.</p>
</div>
<p class="Pp"><b>Offline</b>::<b>StopTerm</b></p>
<div class="Bd-indent">Sends SIGTERM to all PIDs of this instance. Arms <i>Stop
  Timer</i>.
<p class="Pp">On all PIDs exiting, disarms <i>Stop Timer</i>. Transitions to
    <b>Offline</b>::<b>StopKill</b>.</p>
<p class="Pp">On timeout of <i>StopTimer</i>, transitions to
    <b>Offline</b>::<b>StopKill</b>.</p>
</div>
<p class="Pp"><b>Offline</b>::<b>StopKill</b></p>
<div class="Bd-indent">Sends SIGKILL to all PIDs of this instance.
<p class="Pp">If <i>To Maintainenance flag</i> is set, transitions to
    <b>Maintenance</b>.</p>
<p class="Pp">If <i>To Disabled flag</i> is set, transitions to
  <b>Disabled</b>.</p>
<p class="Pp">If <i>To Restart flag</i> is set, transitions to
    <b>Offline</b>::<b>StartPre</b>.</p>
</div>
</section>
</section>
</div>
<table class="foot">
  <tr>
    <td class="foot-date">2021-02-11</td>
    <td class="foot-os"></td>
  </tr>
</table>
</body>
</html>
